<?xml version="1.0" encoding="UTF-8"?>
<html xmlns="http://www.w3.org/1999/xhtml" xmlns:h="http://java.sun.com/jsf/html"
    xmlns:f="http://java.sun.com/jsp/jstl/core" xmlns:ui="http://java.sun.com/jsf/facelets" xmlns:p="http://primefaces.org/ui"
    xmlns:composite="http://java.sun.com/jsf/composite">
    
	<composite:interface componentType="org.metachart.jsf.chart.echarts.Chart">
        
	</composite:interface>
	        
	<composite:implementation>
		
		<div id="#{cc.attrs.chartId}" class="e-chart"></div>
		
					<h:outputScript>

var dom = document.getElementById('#{cc.attrs.chartId}');
var myChart = echarts.init(dom, null, {renderer: 'canvas',useDirtyRect: false});
var option;

function randomData()
{
  now = new Date();
  value = value + Math.random() * 21 - 10;
  return {
    value: [
       [now.getFullYear(), now.getMonth() + 1, now.getDate()].join('-')+' '+[now.getHours(), now.getMinutes(), now.getSeconds()].join(':'),
      Math.round(value),
    ]
  };
}

let data = [];
let now = new Date(1997, 9, 3);
let oneDay = 24 * 3600 * 1000;
let value = Math.random() * 1000;

option = {
  title: {text: 'Time Axis' },
  xAxis: {type: 'time'},
  yAxis: {type: 'value',},
  series: [
    {
      name: 'Fake Data',
      type: 'line',
      showSymbol: false,
      data: data
    }
  ]
};

setInterval(function ()
{
  x = randomData();
  console.log(x);
  data.push(x); 
  myChart.setOption( {series: [{data: data}]} );
}, 1000);

myChart.setOption(option);
window.addEventListener('resize', myChart.resize);

</h:outputScript>
	</composite:implementation>
</html>